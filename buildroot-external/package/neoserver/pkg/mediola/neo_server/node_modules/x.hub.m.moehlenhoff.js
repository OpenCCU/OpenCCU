var x=x||{};x.hub=x.hub||{},x.hub.m=x.hub.m||{},x.hub.m.moehlenhoff=x.hub.m.moehlenhoff||{},x.hub.m.moehlenhoff.APLHA_MODULE=require("xnm.aio.moehlenhoff.js"),x.hub.m.moehlenhoff.Handler=function(){var Handler=function Handler(){};return Handler.prototype.init=function(e){e&&e();},Handler.prototype.getSystems=function(){return["moehlenhoff"];},Handler.prototype.executeCommandV6=function(e,a,t,o){var r,n=e?e.address:null;if(!n)return(r=new Error("invalid device json")).code="000000",void(o&&o(r));var l={sys:"alpha2",ip:a?a.address:null},d=x.hub.m.moehlenhoff.APLHA_MODULE.resolveGateway(l);if(!d)return(r=new Error("invalid gateway json")).code="000000",void(o&&o(r));var i=n.split(":"),u={sys:"alpha2",address:i[0],dpt:"HEATAREA",number:i[1]},v={value:null,ext:null};switch(t.command){case"temperature":v.value="target_temp",v.ext=t.value;break;case"mode":v.value=t.value;break;case"weekday":v.value="w_p"+t.value;break;case"weekend":v.value="we_p"+t.value;break;case"disableVacation":v.value="vac_off",u.dpt="DEVICE";break;case"vacation":if(!t.value||!t.value.start||!t.value.end)return(r=new Error("invalid parameter")).code="000000",void(o&&o(r));v.value="vac_on",v.ext=[{value:"start",ext:t.value.start},{value:"end",ext:t.value.end}],u.dpt="DEVICE";}d.executeCommandCreator(u,v,function(e){e&&(e.code="000000"),o&&o(e);});},Handler.prototype.getStatesV6=function(e,a,t){var o,r=e?e.address:null;if(!r)return(o=new Error("invalid device json")).code="000000",void(t&&t(o));var n={sys:"alpha2",ip:a?a.address:null},l=x.hub.m.moehlenhoff.APLHA_MODULE.resolveGateway(n);if(!l)return(o=new Error("invalid gateway json")).code="000000",void(t&&t(o));l._getStates(function(e,a){if(e)t&&t(e);else{var o=r.split(":"),n={};if(a)for(var l=0;l<a.length;l++){var d=a[l];if(d&&d.id==o[0]&&(void 0!==d.cooling&&(n.cooling="on"==d.cooling?1:0),n.vacation="on"==d.vacation?1:0,d.heatAreas))for(var i=0;i<d.heatAreas.length;i++){var u=d.heatAreas[i];u&&u.number==o[1]&&(n.state=u.target_temp/5,n.temperature=u.actual_temp,n.mode=u.mode,n.battery=u.battery,n.signal=u.signal,n.party=u.party,"active"==u.prog_week_0?n.weekday=0:"active"==u.prog_week_1?n.weekday=1:"active"==u.prog_week_2?n.weekday=2:"active"==u.prog_week_3&&(n.weekday=3),"active"==u.prog_weekend_0?n.weekend=0:"active"==u.prog_weekend_1?n.weekend=1:"active"==u.prog_weekend_2?n.weekend=2:"active"==u.prog_weekend_3&&(n.weekend=3));}}t&&t(null,n);}});},Handler;}(),"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=new x.hub.m.moehlenhoff.Handler());