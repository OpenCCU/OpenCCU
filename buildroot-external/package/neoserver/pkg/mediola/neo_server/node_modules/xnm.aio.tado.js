var xnm=xnm||{};xnm.aio=xnm.aio||{},xnm.aio.tado=xnm.aio.tado||{},xnm.aio.tado.Bridge=function(){var Bridge=function Bridge(e,t){this._logger=require("x.logger.js").getLogger("xnm.aio.tado.Bridge"),this.user=e,this.password=t;};return Bridge.prototype.executeCommandCreator=function(e,t,n){if(t&&t.value){var a=t.value;if("setTo"==t.value){if(null==t.ext||void 0===t.ext)return void(n&&n(new Error("command ext format invalid")));a=t.value+t.ext;}this.executeCommand(a,function(e){n&&n(e);});}else n&&n(new Error("command format invalid"));},Bridge.prototype.getStatesCreator=function(e,t,n){t?this.getState(function(e,a){for(var o=[],r=0;r<t.length;r++){var i=t[r],s="?";if(i.id&&i.status&&i.status.value&&a){var u=a[i.status.value];null!=u&&void 0!==u&&(s=u);}o.push({id:i.id,status:s});}n&&n(null,o);}):n&&n(new Error("deviceList is null"));},Bridge.prototype._doRequest=function(e,t,n){var a=e+"?",o=null;if(t)for(var r in t){t.hasOwnProperty(r)&&(a+=r+"="+encodeURIComponent(t[r])+"&");}o=a,o+="username=xxxxxx&password=xxxxxx";var i={host:"my.tado.com",path:a+="username="+encodeURIComponent(this.user)+"&password="+encodeURIComponent(this.password),method:"GET",headers:{Connection:"close","Content-Type":'application/json; charset="UTF-8"'}};this._logger.log("trace","send https request to:"+o);var s=this,u=require("https").request(i,function(e){e.setEncoding("utf-8");var t="";e.on("data",function(e){t+=e;}),e.on("end",function(){if(s._logger.log("trace","receive https response code:"+e.statusCode+" body:"+t),200==e.statusCode){var a=null;try{a=JSON.parse(t),n&&(n(null,a),n=null);}catch(e){n&&(n(new Error("https response invalid json")),n=null);}}else n&&(n(new Error("https response code:"+e.statusCode),t),n=null);});});u.on("error",function(e){s._logger.log("trace","send https request err:"+e.message),n&&(n(e),n=null);}),u.setTimeout(2e3,function(){s._logger.log("trace","send https request timeout"),u.abort(),n&&(n(new Error("https request timeout")),n=null);}),u.end();},Bridge.prototype.executeCommand=function(e,t){var n=!0,a=null,o=null,r=this;if("auto"==e)a="/mobile/1.9/updateThermostatSettings",o={setMode:"AUTO"};else if("up"==e||"down"==e)this.getState(function(n,a){if(n)t&&t(n);else if(a&&a.mode&&a.temp){var i=parseFloat(a.temp);"up"==e?i+=.5:i-=.5,i<5?i=5:i>25&&(i=25),i=i.toFixed(1),o={setMode:"MANUAL",manualTemp:i},r._doRequest("/mobile/1.9/updateThermostatSettings",o,function(e){t&&t(e);});}else t&&t(n,a);}),n=!1;else if(0==e.indexOf("setTo")){e=(e=e.replace(/setTo/g,"")).replace(/%/g,"");var i=parseFloat(e);i<5?i=5:i>25&&(i=25),i=i.toFixed(1),a="/mobile/1.9/updateThermostatSettings",o={setMode:"MANUAL",manualTemp:i};}a?this._doRequest(a,o,function(e){t&&t(e);}):n&&t&&t();},Bridge.prototype.getState=function(e){var t={},n=this;this._doRequest("/mobile/1.9/getCurrentState",null,function(a,o){a?e(a):(o&&(t.heatingOn=o.heatingOn,t.temp=parseFloat(o.setPointTemp).toFixed(1),t.insideTemp=parseFloat(o.insideTemp).toFixed(1),t.mode=o.operation),o.homeId?n._doRequest("/api/v1/home/"+o.homeId+"/hvacState",null,function(n,a){a&&a.humidity&&(t.humidity=a.humidity.percentage),e&&e(n,t);}):e&&e(a,t));});},Bridge.prototype.getStateValues=function(e,t){return t;},Bridge.prototype.toJSON=function(){return{sys:xnm.aio.tado.DM.SYS,username:this.user,password:this.password};},Bridge.prototype.equalsTo=function(e){return!!e&&e instanceof Bridge&&this.user==e.user&&this.password==e.password;},Bridge.parseJSON=function(e){return e.username&&e.password?new Bridge(e.username,e.password):null;},Bridge;}(),xnm.aio.tado.BridgeV2=function(){var e={},initTerminationInfo=function initTerminationInfo(t,n){var a={temp:20,type:"MANUAL",durationInSeconds:60};return e[t+"_"+n]=a,a;},Bridge=function Bridge(e,t){this._logger=require("x.logger.js").getLogger("xnm.aio.tado.BridgeV2"),this.user=e,this.password=t,this._zoneStateCBS={};};return Bridge.prototype.getZones=function(e){var t=this;this._getMe(function(n,a){if(n)e&&e(n);else{var o=[],r=a.homes,i=0,cb=function cb(n,a){if(!n&&a)for(var s=r[i].id,u=0;u<a.length;u++){var m=a[u];if("AIR_CONDITIONING"!==m.type){var d={name:m.name,type:"zone",homeID:s,zoneID:m.id,zoneType:m.type};o.push(d);}}++i<r.length?t._getZones(r[i].id,cb):e&&e(null,o);};t._getZones(r[i].id,cb);}});},Bridge.prototype.executeCommandCreator=function(e,t,n){t&&t.value?e&&"thermo"==e.type?new xnm.aio.tado.Bridge(this.user,this.password).executeCommandCreator(e,t,n):this.executeCommand(e,t,function(e){n&&n(e);}):n&&n(new Error("command format invalid"));},Bridge.prototype.getStatesCreator=function(e,t,n){if(t){for(var a=[],o=[],r=[],i=0;i<t.length;i++){var s=t[i];s&&s.device&&"thermo"===s.device.type&&r.push(s);var _e=s.device;if(_e&&void 0!==_e.homeID&&null!==_e.homeID&&void 0!==_e.zoneID&&null!==_e.zoneID){var u=_e.homeID+"_"+_e.zoneID;-1==a.indexOf(u)&&o.push(s.device);}}var m=1,d=[];if(r.length>0)m=2,new xnm.aio.tado.Bridge(this.user,this.password).getStatesCreator(e,r,function(e,t){m--,!e&&t&&(d=d.concat(t)),0==m&&n&&n(null,d);});this.getState(o,function(e,a){for(var o=0;o<t.length;o++){var r=t[o];if(r&&r.id){var i="?",s=r.device;if(!e&&a&&s&&void 0!==s.homeID&&null!==s.homeID&&void 0!==s.zoneID&&null!==s.zoneID){var u=a[s.homeID+"_"+s.zoneID];if(u&&r.status&&r.status.value){var l=u[r.status.value];null!=l&&(i=l);}}d.push({id:r.id,status:i});}}0==--m&&n&&n(null,d);});}else n&&n(new Error("deviceList is null"));},Bridge.prototype.executeCommand=function(t,n,a){if(t&&"zone"===t.type&&void 0!==t.homeID&&null!==t.homeID&&void 0!==t.zoneID&&null!==t.zoneID){if(n&&n.value){var o,r,i="GET",s="/api/v2/homes/"+t.homeID+"/zones/"+t.zoneID+"/overlay",u=null;switch(n.value){case"auto":i="DELETE";break;case"off":"HOT_WATER"===t.zoneType?(i="PUT",u={setting:{type:t.zoneType,power:"OFF"},termination:{type:"MANUAL"}}):(o=t.homeID+"_"+t.zoneID,(r=e[o])||(r=initTerminationInfo(t.homeID,t.zoneID)),i="PUT",u={setting:{type:t.zoneType||"HEATING",power:"OFF"},termination:{type:r.type}},"TIMER"===r.type&&(u.termination.durationInSeconds=r.durationInSeconds));break;case"on":i="PUT",u={setting:{type:t.zoneType,power:"ON"},termination:{type:"MANUAL"}};break;case"start":o=t.homeID+"_"+t.zoneID,(r=e[o])||(r=initTerminationInfo(t.homeID,t.zoneID)),i="PUT",u={setting:{type:"HEATING",power:"ON",temperature:{celsius:r.temp}},termination:{type:r.type}},"TIMER"==r.type&&(u.termination.durationInSeconds=r.durationInSeconds);break;case"setManuEndMode":switch(n.ext){case"MANUAL":case"TIMER":case"TADO_MODE":o=t.homeID+"_"+t.zoneID,(r=e[o])||(r=initTerminationInfo(t.homeID,t.zoneID)),r.type=n.ext,a&&a();break;default:return void(a&&a(new Error("setManuEndMode ext invalid")));}return;case"setManuEndTimer":if(!n.ext)return void(a&&a(new Error("setManuEndTimer ext invalid")));var m=parseInt(n.ext);return isNaN(m)&&(m=1),m<1&&(m=1),o=t.homeID+"_"+t.zoneID,(r=e[o])||(r=initTerminationInfo(t.homeID,t.zoneID)),r.durationInSeconds=60*m,void(a&&a());case"setTo":if(!n.ext)return void(a&&a(new Error("setTo ext invalid")));var d=parseFloat(n.ext);d<5?d=5:d>25&&(d=25),d=d.toFixed(1),d=parseFloat(d),o=t.homeID+"_"+t.zoneID,(r=e[o])||(r=initTerminationInfo(t.homeID,t.zoneID)),r.temp=d,a&&a();break;case"up":case"down":var l=parseFloat(n.ext);return l&&!isNaN(l)||(l=1),o=t.homeID+"_"+t.zoneID,(r=e[o])||(r=initTerminationInfo(t.homeID,t.zoneID)),d=r.temp,"up"==n.value?d+=l:d-=l,d<5?d=5:d>25&&(d=25),d=d.toFixed(1),d=parseFloat(d),r.temp=d,void(a&&a());default:return void(a&&a(new Error("unknown command")));}this._doRequest(i,s,JSON.stringify(u),function(e){a&&a(e);});}else a&&a(new Error("command json invalid"));}else a&&a(new Error("device json invalid"));},Bridge.prototype.getState=function(e,t){for(var n={},a=e.length,o=a,cb=function cb(){0==--a&&t&&t(null,n);};o--;){var r=e[o];r&&void 0!==r.homeID&&null!==r.homeID&&void 0!==r.zoneID&&null!==r.zoneID?this.getZoneState(r.homeID,r.zoneID,function(e,t,a,o){!e&&t&&(n[a+"_"+o]=t),cb();}):cb();}},Bridge.prototype.getZoneState=function(e,t,n){var a=e+"_"+t,o=this._zoneStateCBS[a];o||(o=[],this._zoneStateCBS[a]=o);var r=o.length;if(n||(n=function n(){}),-1==o.indexOf(n)&&o.push(n),0==r){var i=this;this._getZoneState(e,t,function(n,r){delete i._zoneStateCBS[a];var s=o.length;if(n)for(;s--;){o[s]&&o[s](n);}else{var u=i._resolveZoneState(r),m=i._getZoneManuTermination(e,t);for(u||(u={}),u.setManutemp=m.setManutemp,u.setManuEndMode=m.setManuEndMode,u.setManuEndTimer=m.setManuEndTimer,s=o.length;s--;){o[s]&&o[s](null,u,e,t);}}});}},Bridge.prototype._getZoneManuTermination=function(t,n){var a=e[t+"_"+n];a||(a=initTerminationInfo(t,n));var o={};return o.setManutemp=a.temp,o.setManuEndMode=a.type,o.setManuEndTimer=a.durationInSeconds,o.setManuEndTimer&&(o.setManuEndTimer=o.setManuEndTimer/60),o;},Bridge.prototype._resolveZoneState=function(e){var t={manuEndTimer:0,manuEndTimerRemainS:0,manuEndTimerRemain:0,manuEndTimerRemainTxt:"",manuEndAutoExpire:null};e.tadoMode&&(t.mode=e.tadoMode),e.overlayType&&(t.mode=e.overlayType);var n,a=e.setting;a&&((n=a.temperature)&&void 0!==n.celsius&&null!=n.celsius&&(t.temp=n.celsius),a.power&&(t.power=a.power,"OFF"==a.power&&(t.temp=0,t.mode="FROZEN_PROTECTION")));var o=e.activityDataPoints;if(o){var r=o.heatingPower;r&&void 0!==r.percentage&&null!=r.percentage&&(t.heatingPower=r.percentage);}var i=e.sensorDataPoints;if(i){var s=i.insideTemperature;s&&void 0!==s.celsius&&null!=s.celsius&&(t.insideTemp=s.celsius);var u=i.humidity;u&&void 0!==u.percentage&&null!=u.percentage&&(t.humidity=u.percentage);}var m=e.overlay;if(m){(a=m.setting)&&((n=a.temperature)&&void 0!==n.celsius&&null!=n.celsius&&(t.temp=n.celsius),a.power&&(t.power=a.power,"OFF"==a.power&&(t.temp=0,t.mode="FROZEN_PROTECTION")));var d=m.termination;if(d)if(d.type&&(t.manuEndMode=d.type),"TIMER"==d.type){t.manuEndTimer=Math.round(d.durationInSeconds/60),t.manuEndTimerRemainS=d.remainingTimeInSeconds,t.manuEndTimerRemain=Math.round(d.remainingTimeInSeconds/60);var l=Math.floor(d.remainingTimeInSeconds/3600),p=Math.floor(d.remainingTimeInSeconds%3600/60),c=d.remainingTimeInSeconds%60;(l=""+l).length<2&&(l="0"+l),(p=""+p).length<2&&(p="0"+p),(c=""+c).length<2&&(c="0"+c),t.manuEndTimerRemainTxt=l+":"+p+":"+c,t.manuEndAutoExpire=null;}else"TADO_MODE"==d.type?(t.manuEndTimer=0,t.manuEndTimerRemainS=0,t.manuEndTimerRemain=0,t.manuEndTimerRemainTxt="",t.manuEndAutoExpire=new Date(d.projectedExpiry).toTimeString()):(t.manuEndTimer=0,t.manuEndTimerRemainS=0,t.manuEndTimerRemain=0,t.manuEndTimerRemainTxt="",t.manuEndAutoExpire=null);}return t;},Bridge.prototype._getMe=function(e){this._doRequest("GET","/api/v2/me",null,function(t,n){e&&e(t,n);});},Bridge.prototype._getZones=function(e,t){var n="/api/v2/homes/"+e+"/zones";this._doRequest("GET",n,null,function(e,n){t&&t(e,n);});},Bridge.prototype._getZoneState=function(e,t,n){var a="/api/v2/homes/"+e+"/zones/"+t+"/state";this._doRequest("GET",a,null,function(e,t){n&&n(e,t);});},Bridge.prototype._doRequest=function(e,t,n,a){var o=t;o+="?username=xxxxxx&password=xxxxxx";var r={host:"my.tado.com",path:t+="?username="+encodeURIComponent(this.user)+"&password="+encodeURIComponent(this.password),method:e,headers:{Connection:"close","Content-Type":'application/json; charset="UTF-8"'}};this._logger.log("trace","do https "+e+" request:"+o),n&&this._logger.log("trace","https body:"+n);var i=this,s=require("https").request(r,function(e){e.setEncoding("utf-8");var t="";e.on("data",function(e){t+=e;}),e.on("end",function(){if(i._logger.log("trace","receive https response code:"+e.statusCode+" body:"+t),200==e.statusCode||204==e.statusCode){var n=null;try{(204!=e.statusCode||t)&&(n=JSON.parse(t)),a&&(a(null,n),a=null);}catch(e){a&&(a(new Error("https response invalid json")),a=null);}}else a&&(a(new Error("https response code:"+e.statusCode),t),a=null);});});s.on("error",function(e){i._logger.log("trace","send https request err:"+e.message),a&&(a(e),a=null);}),s.setTimeout(2e3,function(){i._logger.log("trace","send https request timeout"),s.abort(),a&&(a(new Error("https request timeout")),a=null);}),n&&s.write(n),s.end();},Bridge.prototype.toJSON=function(){return{sys:xnm.aio.tado.DM.SYS,username:this.user,password:this.password};},Bridge.prototype.equalsTo=function(e){return!!e&&e instanceof Bridge&&this.user==e.user&&this.password==e.password;},Bridge.parseJSON=function(e){return e.username&&e.password?new Bridge(e.username,e.password):null;},Bridge;}(),xnm.aio.tado.DM=function(){var DMError=function DMError(e,t){this.code=e,this.message=t,this.stack=new Error().stack;};(DMError.prototype=new Error()).name="TadoDMError",DMError.prototype.code=0,DMError.ERROR_CODE={DEFAULT:0,INDEX_EXISTS:1,ID_EXISTS:2,INVALID:3,UNKNOW:4,NOT_FOUND:5,IP_EXISTS:6};var e={thermo:{command:[{type:"enum",name:"auto",ref:{value:"auto"}},{type:"enum",name:"up",ref:{value:"up"}},{type:"enum",name:"down",ref:{value:"down"}},{type:"float",name:"manu",ref:{value:"setTo",ext:"%f",extMeta:"5.0-25.0",scale:"0.1"}}],status:[{type:"enum",name:"mode",ref:{value:"mode",options:["HOME","SLEEP","AWAY","MANUAL","NO_FREEZE"]}},{type:"float",name:"set temperature",ref:{value:"temp",extMeta:"5.0-25.0",scale:"0.1"}},{type:"float",name:"current temperature",ref:{value:"insideTemp"}},{type:"int",name:"humidity",ref:{value:"humidity"}}]},HOT_WATER:{command:[{type:"enum",name:"off",ref:{value:"off"}},{type:"enum",name:"on",ref:{value:"on"}}],status:[{type:"enum",name:"power",ref:{value:"power",options:["on","off"]}},{type:"float",name:"set temperature",ref:{value:"temp"}}]},zone:{command:[{type:"enum",name:"auto",ref:{value:"auto"}},{type:"enum",name:"off",ref:{value:"off"}},{type:"enum",name:"start",ref:{value:"start"}},{type:"float",name:"set manu temperature",ref:{value:"setTo",value_t:"temperature",ext:"%f",extMeta:"5.0-25.0",scale:"0.1"}},{type:"enum",name:"set manu termination mode",ref:{value:"setManuEndMode",ext:"%e",extMeta:["MANUAL","TIMER","TADO_MODE"]}},{type:"int",name:"set manu termination timer",ref:{value:"setManuEndTimer",ext:"%d",extMeta:"1-720",unit:"min"}},{type:"float",name:"up",ref:{value:"up",ext:"%f",extMeta:"0.1-5.0",scale:"0.1"}},{type:"float",name:"down",ref:{value:"down",ext:"%f",extMeta:"0.1-5.0",scale:"0.1"}}],status:[{type:"enum",name:"mode",ref:{value:"mode",options:["HOME","SLEEP","AWAY","MANUAL","NO_FREEZE","FROZEN_PROTECTION"]}},{type:"enum",name:"power",ref:{value:"power",options:["on","off"]}},{type:"float",name:"current temperature",ref:{value:"insideTemp"}},{type:"int",name:"humidity",ref:{value:"humidity"}},{type:"int",name:"heating power",ref:{value:"heatingPower"}},{type:"float",name:"set temperature",ref:{value:"temp",extMeta:"5.0-25.0",scale:"0.1"}},{type:"enum",name:"current manu termination mode",ref:{value:"manuEndMode",ext:"%e",options:["MANUAL","TIMER","TADO_MODE"]}},{type:"int",name:"current manu termination timer",ref:{value:"manuEndTimer",ext:"%d",extMeta:"1-720",unit:"min"}},{type:"string",name:"current manu termination auto expire time",ref:{value:"manuEndAutoExpire",ext:"%s"}},{type:"int",name:"current manu termination timer remain (min)",ref:{value:"manuEndTimerRemain",unit:"min"}},{type:"int",name:"current manu termination timer remain (s)",ref:{value:"manuEndTimerRemainS",unit:"s"}},{type:"string",name:"current manu termination timer remain (text)",ref:{value:"manuEndTimerRemainTxt"}},{type:"float",name:"set manu temperature",ref:{value:"setManutemp",extMeta:"5.0-25.0",scale:"0.1"}},{type:"enum",name:"set manu termination mode",ref:{value:"setManuEndMode",ext:"%e",options:["MANUAL","TIMER","TADO_MODE"]}},{type:"int",name:"set manu termination timer",ref:{value:"setManuEndTimer",ext:"%d",extMeta:"1-720",unit:"min"}}]}};return{SYS:"tado",getGatewayType:function getGatewayType(){return[{sys:this.SYS,name:"tado°"}];},getGatewayDeviceType:function getGatewayDeviceType(e,t){return[{type:"thermo",name:"Smart Thermostat",sys:this.SYS}];},createGateway:function createGateway(e,t,n){var a=DMError,o=DMError.ERROR_CODE;e?e.username?e.password?n(null,e):n(new a(o.INVALID,"password is invalid")):n(new a(o.INVALID,"username is invalid")):n(new a(o.INVALID,"info is invalid"));},updateGateway:function updateGateway(e,t,n,a){var o=DMError,r=DMError.ERROR_CODE;t?t.username?t.password?a(null,t):a(new o(r.INVALID,"password is invalid")):a(new o(r.INVALID,"username is invalid")):a(new o(r.INVALID,"info is invalid"));},deleteGateway:function deleteGateway(e,t,n){n();},createDevice:function createDevice(e,t,n){var a=DMError,o=DMError.ERROR_CODE;if(e){if(e.gateway){if(e.type){if(t.data&&t.data.gateways&&0!==t.data.gateways.length){var r,i,s=t.data.gateways;for(r=0;r<s.length;r++){if(s[r].index===e.gateway){i=s[r];break;}}i?n(null,e):n(new a(o.NOT_FOUND,"gateway with index "+e.gateway+" not exists"));}else n(new a(o.NOT_FOUND,"gateway with index "+e.gateway+" not exists"));}else n(new a(o.INVALID,"type is invalid"));}else n(new a(o.INVALID,"gateway is invalid"));}else n(new a(o.INVALID,"info is invalid"));},updateDevice:function updateDevice(e,t,n){var a=DMError,o=DMError.ERROR_CODE;if(e){if(e.gateway){if(e.type){if(t.data&&t.data.gateways&&0!==t.data.gateways.length){var r,i,s=t.data.gateways;for(r=0;r<s.length;r++){if(s[r].index===e.gateway){i=s[r];break;}}i?n(null,e):n(new a(o.NOT_FOUND,"gateway with index "+e.gateway+" not exists"));}else n(new a(o.NOT_FOUND,"gateway with index "+e.gateway+" not exists"));}else n(new a(o.INVALID,"type is invalid"));}else n(new a(o.INVALID,"gateway is invalid"));}else n(new a(o.INVALID,"info is invalid"));},deleteDevice:function deleteDevice(e,t,n){n();},applyUIFilter:function applyUIFilter(e,t,n){var a=this,_doFilterArr=function _doFilterArr(e,t,n){var a=[];return e.forEach(function(e){if("root"==e.type){var o=JSON.parse(JSON.stringify(e)),r=_doFilterArr(o.children,t,n);r&&r.length>0&&(o.children=r,a.push(o));}else if(function(e,t){if("*"==e)return!0;for(var n=!1,a=0;a<e.length;a++){if(e[a]==t){n=!0;break;}}return n;}(n.elems,e.type)){var i=JSON.parse(JSON.stringify(e));a.push(i);}}),a;},_filter=function _filter(e,t){var o=[],r=null,i=a.getCommandStatusMap(e,n);return i&&(r=function(e,t,n){var a=[];switch(n.catagory){case"command":e.command&&(a=_doFilterArr(e.command,t,n));break;case"status":e.status&&(a=_doFilterArr(e.status,t,n));}return a;}(i,e,t),o=o.concat(r)),o;};if(!e.sys)return null;var o=JSON.parse(JSON.stringify(e)),r=null;switch(t.catagory){case"command":r=_filter(e,t),o.command=r;break;case"status":r=_filter(e,t),o.status=r;break;default:return null;}return r&&0!=r.length?o:null;},getCommandStatusMap:function getCommandStatusMap(t){return t&&t.type?e[t.zoneType]||e[t.type]:null;}};}(),xnm.aio.tado.Handler=function(){var Handler=function Handler(){};return Handler.prototype.Bridge=xnm.aio.tado.Bridge,Handler.prototype.BridgeV2=xnm.aio.tado.BridgeV2,Handler.prototype.devicemanager=xnm.aio.tado.DM,Handler.prototype.registModule=function(e){e.register(this.devicemanager.SYS,"tado");},Handler.prototype.resolveGateway=function(e){return e?this.BridgeV2.parseJSON(e):null;},Handler.prototype.getDeviceCommands=function(e,t){var n=this.devicemanager.applyUIFilter(e,{catagory:"command",elems:"*"}),a=n?n.command:[];t&&t(null,a);},Handler.prototype.getDeviceStatus=function(e,t){var n=this.devicemanager.applyUIFilter(e,{catagory:"status",elems:"*"}),a=n?n.status:[];t&&t(null,a);},Handler.prototype.doCommand=function(e,t,n,a){var o=this.resolveGateway(e);o?o.executeCommandCreator(t,n,function(e){a&&a(e);}):a&&a(new Error("gateway json format invalid"));},Handler.prototype.doStatus=function(e,t,n,a,o){var r=this.resolveGateway(t);if(r){var i=[{id:e,device:n,status:a}];r.getStatesCreator(null,i,function(e,t){e?o&&o(e):o&&o(null,t[0]);});}else o&&o(new Error("gateway json format invalid"));},Handler.prototype.getDeviceList=function(e,t){var n=this.resolveGateway(e);n?n.getZones(function(e,n){t&&t(e,n);}):t&&t(new Error("gateway json format invalid"));},Handler.prototype.getStateValues=function(e,t){},Handler.prototype.getDeviceCommandList=function(e,t,n){var a=[];return t&&(a.push({id:window.XC_Text.on,cmd:"on"}),a.push({id:window.XC_Text.off,cmd:"off"})),a;},Handler;}(),"undefined"!=typeof module&&null!=module&&(module.exports=new xnm.aio.tado.Handler());