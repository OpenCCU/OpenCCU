var x=x||{};x.videoplayer=x.videoplayer||{},x.videoplayer.Player=function(){var Player=function Player(e){this._options=e,this._listeners={};};Player.prototype.on=function(e,t){e&&t&&(this._listeners[e]||(this._listeners[e]=[]),-1==this._listeners[e].indexOf(t)&&this._listeners[e].push(t));},Player.prototype.off=function(e,t){if(e&&t&&this._listeners[e]){var r=this._listeners[e].indexOf(t);-1!=r&&this._listeners[e].splice(r,1);}},Player.prototype.init=function(e){throw new Error("func init not implemented");},Player.prototype.playHLS=function(e){},Player.prototype.playFLV=function(e){},Player.prototype._emitEvent=function(e,t){if(e){var r=this._listeners[e];if(r&&r.length>0)for(var i=0;i<r.length;i++){var o=r[i];try{o(t);}catch(t){this._logger.log("trace","call "+e+" listener failed, error:"+t.message);}}}};var MobilePlayer=function MobilePlayer(e){Player.call(this,e),this._logger=require("x.logger.js").getLogger("x.videoplayer.MobilePlayer"),this._playerID=null;var t=this;this._nativeListener=function(e){e?e.error?t._emitEvent("error",new Error(e.error)):e.close?t._emitEvent("close"):e.start?t._emitEvent("start"):e.end?t._emitEvent("end"):e.replay?t._emitEvent("replay"):e.init&&(e.init.error?t._emitEvent("init",new Error(e.init.error)):(t._playerID=e.init.playerID,t._emitEvent("init"))):t._emitEvent("error",new Error("native bridge error"));};};return(MobilePlayer.prototype=new Player()).constructor=MobilePlayer,MobilePlayer.prototype.init=function(e){e&&this.on("init",e),XC.callHost("videoplayer","createPlayer",this._options?this._options:{},this._nativeListener);},MobilePlayer.prototype.playHLS=function(e,t){XC.callHost("videoplayer","playHLS",{playerID:this._playerID,url:e,duration:t});},MobilePlayer.prototype.playMP4=function(e,t,r){XC.callHost("videoplayer","playMP4",{playerID:this._playerID,url:e,duration:t,options:r});},MobilePlayer.prototype.playRTSP=function(e,t){XC.callHost("videoplayer","playRTSP",{playerID:this._playerID,url:e,transport:t});},MobilePlayer.prototype.playMultiHLS=function(e){XC.callHost("videoplayer","playMultiHLS",{playerID:this._playerID,urls:e});},MobilePlayer.prototype.playFLV=function(e,t){XC.callHost("videoplayer","playFLV",{playerID:this._playerID,url:e,duration:t});},MobilePlayer.prototype.close=function(){XC.callHost("videoplayer","closePlayer",{playerID:this._playerID});},Player.iOSPlayer=MobilePlayer,Player.AndroidPlayer=MobilePlayer,Player;}(),x.videoplayer.Handler=function(){var H=function H(){};return H.prototype.createVideoPlayer=function(e,t){var r=null,i=null;"undefined"!=typeof window&&null!=window&&window.XCHost||(r="node-webkit"),"undefined"!=typeof window&&null!=window&&window.XCHost&&window.XCHost.getType&&(r=window.XCHost.getType()),(i="Android"==r?new x.videoplayer.Player.AndroidPlayer(e):"node-webkit"==r||"undefined"!=typeof process&&null!=process&&"node"==process.title?new x.videoplayer.Player.NWPlayer(e):new x.videoplayer.Player.iOSPlayer(e)).init(function(e){t&&t(e,i);});},H;}(),"undefined"!=typeof module&&null!=module&&(module.exports=new x.videoplayer.Handler());