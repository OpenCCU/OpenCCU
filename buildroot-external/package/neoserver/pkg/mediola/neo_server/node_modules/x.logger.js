var x=x||{};x.Logger={_level:0,_file:null,_fileMaxSize:200,_levelMap:{},_fileMap:{},_fileSizeMap:{},_logRoot:null,_logTrackerMap:{},_log2consoleMap:{},getLogger:function getLogger(e){return new x.Logger._LoggerImpl(e);},setLevel:function setLevel(e,r){if(e&&"string"==typeof e){var t=x.Logger._resolveLevel(e);t>=0&&(r?x.Logger._levelMap[r]=t:x.Logger._level=t);}},getAll:function getAll(){var e={};for(var r in e.defaultLevel=this._level2Str(x.Logger._level),x.Logger._levelMap){var t=x.Logger._levelMap[r];e[r]=this._level2Str(t);}return e;},setFile:function setFile(e){x.Logger._file=e;},getFile:function getFile(){return x.Logger._file;},setLogFolder:function setLogFolder(e){x.Logger._logRoot=e;},getLogFolder:function getLogFolder(){return x.Logger._logRoot;},setTagFile:function setTagFile(e,r){e&&r&&(this._fileMap[e]=r);},getTagFiles:function getTagFiles(){return this._fileMap;},setTagFileNode:function setTagFileNode(e,r){if(e&&r&&this._logRoot){var t=require("path");this._fileMap[e]=t.resolve(this._logRoot,r);}},setFileSize:function setFileSize(e,r){e&&r&&(this._fileSizeMap[e]=r);},getFileSize:function getFileSize(e){return this._fileSizeMap[e];},setLogToConsole:function setLogToConsole(e,r){this._log2consoleMap[r]=e;},getLogToConsole:function getLogToConsole(e){var r=this._matchKeyForTag(e,this._log2consoleMap);return null==r&&(r=!0),r;},setLogTracker:function setLogTracker(e,r){e&&r&&(this._logTrackerMap[e]||(this._logTrackerMap[e]=[]),-1==this._logTrackerMap[e].indexOf(r)&&this._logTrackerMap[e].push(r));},removeLogTracker:function removeLogTracker(e,r){if(e&&this._logTrackerMap[e]){var t=-1;r&&(t=this._logTrackerMap[e].indexOf(r)),-1!=t&&this._logTrackerMap[e].splice(t,1);}},getLogTrackers:function getLogTrackers(e){if(!e)return[];for(var r=e.split("."),t=[];r.length>0;){var o=r.join(".");if(this._logTrackerMap[o]){t=t.concat(this._logTrackerMap[o]);break;}r.splice(r.length-1,1);}return t;},_matchKeyForTag:function _matchKeyForTag(e,r){if(!e)return null;for(var t=e.split("."),o=null;t.length>0;){if(void 0!==(o=r[t.join(".")])&&null!=o)break;t.splice(t.length-1,1);}return o;},_level2Str:function _level2Str(e){switch(e){case 0:return"all";case 1:return"trace";case 1.1:return"trace_l1";case 1.2:return"trace_l2";case 1.3:return"trace_l3";case 2:return"debug";case 3:return"info";case 4:return"warn";case 5:return"error";case 6:return"fatal";default:return"unknown";}},_resolveLevel:function _resolveLevel(e){switch(e.toLowerCase()){case"all":return 0;case"trace":case"trace_l0":return 1;case"trace_l1":return 1.1;case"trace_l2":return 1.2;case"trace_l3":return 1.3;case"debug":return 2;case"info":return 3;case"warn":return 4;case"error":return 5;case"fatal":return 6;default:return-1;}},_getLevel:function _getLevel(e){if(!e)return x.Logger._level;for(var r=e.split("."),t=x.Logger._level;r.length>0;){var o=r.join("."),l=x.Logger._levelMap[o];if(void 0!==l&&null!=l)return l;r.splice(r.length-1,1);}return t;},_getFile:function _getFile(e){if(!e)return null;for(var r,t=e.split(".");t.length>0;){var o=t.join("."),l=this._fileMap[o];if(l){r=l;break;}t.splice(t.length-1,1);}return r;}},x.Logger._LoggerImpl=function(e){this.tag=e,this._queue=[];},x.Logger._LoggerImpl.prototype.log=function(e,r){var t=x.Logger._resolveLevel(e);if(t>=0&&t>=x.Logger._getLevel(this.tag)){var o=new Date(),l=o.getDate()+"/"+(o.getMonth()+1)+"/"+o.getFullYear()+" "+o.getHours()+":"+o.getMinutes()+":"+o.getSeconds()+"."+(o.getMilliseconds()/1e3).toFixed(3).slice(2,5)+" "+e+": ["+this.tag+"] "+r;this._write(l);}},x.Logger._LoggerImpl.prototype._write=function(e){var r=x.Logger.getLogTrackers(this.tag);if(r&&r.length>0)for(var t=0;t<r.length;t++){var o=r[t];o&&o(e);}if(!x.Logger._logWriter&&"undefined"!=typeof XC&&null!=XC&&XC.createObject&&(x.Logger._logWriter=XC.createObject("x.logger.writer")),x.Logger._logWriter){x.Logger.getLogToConsole(this.tag)&&x.Logger._logWriter.writeConsole(e);var l=x.Logger._getFile(this.tag),g=x.Logger.getFileSize(l);if(g||(g=x.Logger._fileMaxSize),l&&x.Logger._logRoot){var i=require("path").resolve(x.Logger._logRoot,l);x.Logger._logWriter.writeFile(e,i,g);}else x.Logger._file&&x.Logger._logWriter.writeFile(e,x.Logger._file,g);}},"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=x.Logger);