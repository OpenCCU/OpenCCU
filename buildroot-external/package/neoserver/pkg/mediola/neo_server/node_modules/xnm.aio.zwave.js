function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}var xnm=xnm||{};xnm.aio=xnm.aio||{},xnm.aio.zwave=xnm.aio.zwave||{},xnm.aio.zwave.ZWave=function(){this.ID="zwave",this.NAME="Z-Wave",this.GDT_ID="ZWAVE",this.GDT_ID2="ZWAVE2",this.CAN_BE_CONFIGURED=["37","38","49","64","67"];},xnm.aio.zwave.ZWave.prototype.canDeviceBeConfigured=function(e){if(!this.hasKey(e,["info","dpts"]))return!1;for(var n in e.info.dpts){if(this.CAN_BE_CONFIGURED.indexOf(n)>=0)return!0;}return!1;},xnm.aio.zwave.ZWave.prototype.exclusion=function(e,n,t){var s="http://".concat(e.info.ip,":").concat(e.info.port,"/cmd"),o={XC_FNC:"ZWaveExclusion",address:-1};this.hasKey(n,["info","address"])&&(XC.debugf("[AIO.ZWAVE.exclusion] Device given. Address: ".concat(n.info.address)),delete o.address),e.info.password&&(o.auth=e.info.password),$.ajax({cache:!1,data:o,dataType:"json",url:s,success:function success(e,n,s){var o=null;e.XC_ERR?(o=new Error(s.responseText),XC.debugf("[AIO.ZWAVE.exclusion] "+o.message)):XC.debugf("[AIO.ZWAVE.exclusion] "+s.responseText),t&&t(o,e);},error:function error(e,n,s){var o=new Error(s||n);XC.debugf("[AIO.ZWAVE.exclusion] "+o.message),t&&t(o);}});},xnm.aio.zwave.ZWave.prototype.getDeviceSettings=function(e,n,t){var s="http://".concat(e.info.ip,":").concat(e.info.port,"/cmd"),o={XC_FNC:"ZWaveGetDeviceSetting",deviceID:n.info.address};e.info.password&&(o.auth=e.info.password),$.ajax({cache:!1,contentType:"application/json",data:JSON.stringify(o),dataType:"json",method:"POST",url:s,success:function success(e,n,s){var o=null;e.XC_ERR?(o=new Error(s.responseText),XC.debugf("[AIO.ZWAVE.getDeviceSettings] "+o.message)):XC.debugf("[AIO.ZWAVE.getDeviceSettings] "+s.responseText),t&&t(o,e.XC_SUC);},error:function error(e,n,s){var o=new Error(s||n);XC.debugf("[AIO.ZWAVE.getDeviceSettings] "+o.message),t&&t(o);}});},xnm.aio.zwave.ZWave.prototype.getInterviewResults=function(e,n,t){var _this=this;var s="http://".concat(e.info.ip,":").concat(e.info.port,"/cmd"),o={XC_FNC:"ZWaveListInterviewResults",address:n.info.address};e.info.password&&(o.auth=e.info.password),$.ajax({cache:!1,data:o,dataType:"json",url:s,success:function success(e,n,s){var o=null;e.XC_ERR?(o=new Error(s.responseText),XC.debugf("[AIO.ZWAVE.getInterviewResults] "+o.message)):XC.debugf("[AIO.ZWAVE.getInterviewResults] "+s.responseText),_this.isObject(e.XC_SUC)||(o=new Error("No error response, but no XC_SUC data either.")),t&&t(o,e.XC_SUC);},error:function error(e,n,s){var o=new Error(s||n);XC.debugf("[AIO.ZWAVE.getInterviewResults] "+o.message),t&&t(o);}});},xnm.aio.zwave.ZWave.prototype.interview=function(e,n,t,s){var o="ws://".concat(e.info.ip,":").concat(e.info.port,"/zwave2/inclusion"),r={command:"start"};n&&(r.command="updateInterview",r.address=n.info.address,r.instanceID=n.info.instance,r.commandClassID=t);var i=JSON.stringify(r),a=new WebSocket(o);a.onclose=function(e,n){XC.debugf("[AIO.ZWAVE.interview] WebSocket closed. Code: ".concat(e,". Message: ").concat(n,"."));},a.onerror=function(e){XC.debugf("[AIO.ZWAVE.interview] "+e.message),a.close(),s&&s(e,null);},a.onopen=function(){a.send(i,null,function(e){e?(XC.debugf("[AIO.ZWAVE.interview] "+e.message),s&&s(e,null)):XC.debugf("[AIO.ZWAVE.interview] Send command \"".concat(r.command,"\"."));});},a.onmessage=function(e,n){var t=e.data,o=null;try{o=JSON.parse(t);}catch(e){return XC.debugf("[AIO.ZWAVE.interview] "+e.message),a.close(),void(s&&s(e,null));}(1===o.progress||o.finish)&&XC.debugf("[AIO.ZWAVE.interview] "+t),o.finish&&a.close(),s&&s(null,o);};},xnm.aio.zwave.ZWave.prototype.setDeviceSettings=function(e,n,t,s){var o="http://".concat(e.info.ip,":").concat(e.info.port,"/cmd"),r={XC_FNC:"ZWaveSetDeviceSetting",deviceID:n.info.address,setting:t};e.info.password&&(r.auth=e.info.password),$.ajax({cache:!1,contentType:"application/json",data:JSON.stringify(r),dataType:"json",method:"POST",url:o,success:function success(e,n,t){var o=null;e.XC_ERR?(o=new Error(t.responseText),Log.error("[AIO.ZWAVE.setDeviceSettings] "+o.message)):Log.debug("[AIO.ZWAVE.setDeviceSettings] "+t.responseText),s&&s(o,e.XC_SUC);},error:function error(e,n,t){var o=new Error(t||n);Log.error("[AIO.ZWAVE.setDeviceSettings] "+o.message),s&&s(o);}});},xnm.aio.zwave.ZWave.prototype.isObject=function(e){return"object"==_typeof(e)&&null!==e;},xnm.aio.zwave.ZWave.prototype.hasKey=function(e,n){if(null===e||"object"!=_typeof(e)||!n)return!1;Array.isArray(n)||(n=[n]);var t=e;for(var _e=0;_e<n.length;_e++){var s=n[_e];if("object"!=_typeof(t)||null===t)return!1;if(void 0===t[s])return!1;t=t[s];}return!0;},xnm.aio.zwave.Handler=xnm.aio.zwave.ZWave,"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&(exports=module.exports=new xnm.aio.zwave.Handler());